
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>Jumbotron Template · Bootstrap</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/jumbotron/">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
      body {
        padding-top: 3.5rem;
      }
      .card {
        text-align:center;
        border: 1px solid #ccc;
        border-radius: 20px;
        margin: 10px;
      }
      .card:hover {
        border: 1px solid #c00;
      }
      .winner {
        border: 2px solid #0c0;
      }
    </style>

</head>
<body>

<main role="main">

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
        <div class="container">
            <h1 class="display-3">Player <span id="currentPlayerIndex">1</span> to move</h1>
            <div class="row" id="movesRow">
                <div class="col-md-2 card">
                    <h2>2♣</h2>
                    <p>Some description</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Example row of columns -->
        <div class="row" id="cardsRow">
            <div class="col-md-2">
                <h2>2♣</h2>
                <p>Some description</p>
            </div>
        </div>
    </div> <!-- /container -->

    <hr>

    <div class="container" id="pastMovesRow">
        <!-- Example row of columns -->
        <div class="row">
            <div class="col-md-1 card">
                <h2>2♣</h2>
                <p>Player 1</p>
            </div>
        </div>
    </div> <!-- /container -->

</main>

<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script>
    var localstore = window.localStorage;
    var playerId = localstore.getItem("playerId");
    var gameId = localstore.getItem("gameId");

    var statusAPI = "http://127.0.0.1:8080/game/" + gameId + "/" + playerId + "/status";
    var moveAPI = "http://127.0.0.1:8080/game/" + gameId + "/" + playerId + "/move/";
    var curStatus = {};
    var curPlayer = 0;

    function init() {
        $.get(statusAPI, function(data) {
            curStatus = data;

            // check status and redirect to correct method


            curMove = data.moves[data.moves.length-1];

            curPlayer = curMove.previousWinner;
            if( curMove.card[curPlayer] != null ) {
                while( curMove.card[curPlayer] != null ) {
                    curPlayer = (curPlayer + 1) %4;
                }
            }

            $("#currentPlayerIndex").text(curPlayer+1);
            displayCurrentMoves(curMove);
            displayCardsForPlayer( data.players[curPlayer].cards);
            displayPastMoves(data.moves);
        });
    }

    function displayPastMoves(moves) {
        moveshtml = "";
        moves.forEach( function(e, i) {
            if( i == moves.length-1 ) {
                return;
            }

            moveshtml += "<div class=\"row\">";
            e.card.forEach( function( ce, ci) {
                moveshtml += "<div class=\"col-md-1 card ";
                if( e.winnerIndex == ci ) {
                    moveshtml += "winner";
                }
                moveshtml += "\"><h2>" + ce + "</h2><p>Player "+ (ci+1) +"</div>";
            });
            moveshtml += "</div>";
        });

        $("#pastMovesRow").html(moveshtml);
    }

    function displayCurrentMoves(curMove) {
        cards = curMove.card;
        moveshtml = "";
        cards.forEach( function(e, i) {
            if( e == null ) {
                moveshtml = moveshtml + "<div class=\"col-md-2 card\"><h2>-</h2><p>Player " + (i+1) + "</div>";
            } else {
                moveshtml = moveshtml + "<div class=\"col-md-2 card\"><h2>" + e + "</h2><p>Player " + (i+1) + "</div>";
            }
        });
        $("#movesRow").html(moveshtml);
    }

    function move(element) {
        var selectedCard = $($(element).children("h2")[0]).text()
        var suit = selectedCard[ selectedCard.length - 1 ];
        var face = selectedCard.replace( suit, "" );

        switch( suit ) {
            case "♠": suit = "SPADES"; break;
            case "♣": suit = "CLUBS"; break;
            case "♥": suit = "HEARTS"; break;
            case "♦": suit = "DIAMONDS"; break;
        }

        switch( face ) {
            case "5": face = "FIVE"; break;
            case "7": face = "SEVEN"; break;
            case "8": face = "EIGHT"; break;
            case "9": face = "NINE"; break;
            case "10": face = "TEN"; break;
            case "J": face = "JACK"; break;
            case "Q": face = "QUEEN"; break;
            case "K": face = "KING"; break;
            case "A": face = "ACE"; break;
        }

        moveFaceSuit( face, suit );
    }

    function moveFaceSuit(face, suit) {
        $.get(moveAPI + curPlayer + "/" + face + "/" + suit, function(data) {
            init();
        });
    }

    function displayCardsForPlayer(cards) {
        cardshtml = "";
        cards.forEach( function(e, i) {
            cardshtml = cardshtml + "<div class=\"col-md-1 card\" onclick=\"move(this);\"><h2>" + e + "</h2></div>";
        });
        $("#cardsRow").html(cardshtml);
    }

</script>

<script>
    $(document).ready( function() { init(); } );
</script>


</body>
</html>
